
<html>
<head>
<title>Greasemonkey で 超お手軽に jQuery を使うスニペット [Chrome 対応版] - OTCHY.NET</title>
<link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/mini.css/3.0.1/mini-default.min.css>
<meta name=viewport content="width=device-width,initial-scale=1">
<style>:root{--back-color:#fff}.prev{text-align:left}.prev::before{transform:rotateZ(180deg)}.next{text-align:right}.next::after,.prev::before{display:inline-block;content:"➤"}</style>
</head>
<body>
<header class="sticky row">
<div class="col-sm-12 col-md-10 col-md-offset-1">
<a href=/ class=button>Home</a>
<a href=/javascript/ class=button>JavaScript</a>
<a href=/greasemonkey/ class=button>Greasemonkey</a>
<a href=/php/ class=button>PHP</a>
</div>
</header>
<main class=container>
<div class=row>
<div class="col-sm-12 col-md-10 col-md-offset-1">
<h1>Greasemonkey で 超お手軽に jQuery を使うスニペット [Chrome 対応版]</h1>
<hr>
</div>
</div>
<div class=row>
<div class="col-sm-12 col-md-10 col-md-offset-1">
旧版である、<a href=/20091104/use-jquery-on-greasemonkey/ >Greasemonkey で 超お手軽に jQuery を使うスニペット</a> は Firefox で使用する分には問題ないのですが、Chrome ではセキュリティ上の都合か、Greasemoneky 上における unsafeWindow が unsafe では無いようで (？) unsafeWindow.jQuery などに Greasemoneky からアクセスすることが出来ません。<br>
<br>
そこで、Chrome 対応版のスニペットを用意しました。<br>
ただ、いわば Chrome のセキュリティを回避した書き方になるため、旧版にあった、「該当ページですでに jQuery が読み込まれていればそれを利用」という特徴が失われてしまっています。<br>
逆に言えば、常に自分で指定したバージョンを利用できるので、jQuery の新しい機能を使ったスクリプトを書く場合などは、こちらのほうが優れています。<br>
<br>
<h4>スクリプト</h4>
<pre>(function (d, func) {
    var h = d.getElementsByTagName('head')[0];
    var s1 = d.createElement("script");
    s1.setAttribute("src", "http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js");
    s1.addEventListener('load', function() {
        var s2 = d.createElement("script");
        s2.textContent = "jQuery.noConflict();(" + func.toString() + ")(jQuery);";
        h.appendChild(s2);
    }, false);
    h.appendChild(s1);
})(document, function($) {
    // ここにメインの処理を書く
    $('#button').click(function(){
        alert('clicked!');
    });
});
</pre>
</div>
</div>
<div class=row>
<div class="col-sm-12 col-md-10 col-md-offset-1">
<hr>
カテゴリ:
<a href=/category/dev/ >Development</a>
タグ:
<a href=/tag/greasemonkey/ >greasemonkey</a>
<a href=/tag/jquery/ >jquery</a>
<a href=/tag/javascript/ >javascript</a>
</div>
</div>
<div class=row>
<div class="col-sm-12 col-md-10 col-md-offset-1">
<hr>
</div>
<div class="col-sm-12 col-md-10 col-md-offset-1 col-lg-5 col-lg-offset-1 prev">
<a href=/20110606/facebook-is-not-closing-down-google/ >Facebook が Google を廃業に追い込めない理由</a>
</div>
<div class="col-sm-12 col-md-10 col-md-offset-1 col-lg-5 col-lg-offset-0 next">
<a href=/20110608/hatebu-downgrader-101-had-released/ >はてブエントリーページを旧仕様っぽくする Greasemonkey</a>
</div>
</div>
</main>
<footer>
<div class="col-sm-12 col-md-10 col-md-offset-1">
Copyright © OTCHY.NET authored by <a href=https://twitter.com/otchy target=_blank>@otchy</a>
</div>
</footer>
</body>
</html>
