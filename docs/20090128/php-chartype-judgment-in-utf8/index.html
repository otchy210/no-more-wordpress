
<html>
<head>
<title>PHP で日本語のひらがなとカタカナと漢字を判別する方法 [UTF-8編] - OTCHY.NET</title>
<link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/mini.css/3.0.1/mini-default.min.css>
<meta name=viewport content="width=device-width,initial-scale=1">
<style>:root{--back-color:#fff}.prev{text-align:left}.prev::before{transform:rotateZ(180deg)}.next{text-align:right}.next::after,.prev::before{display:inline-block;content:"➤"}</style>
</head>
<body>
<header class="sticky row">
<div class="col-sm-12 col-md-10 col-md-offset-1">
<a href=/ class=button>Home</a>
<a href=/javascript/ class=button>JavaScript</a>
<a href=/greasemonkey/ class=button>Greasemonkey</a>
<a href=/php/ class=button>PHP</a>
</div>
</header>
<main class=container>
<div class=row>
<div class="col-sm-12 col-md-10 col-md-offset-1">
<h1>PHP で日本語のひらがなとカタカナと漢字を判別する方法 [UTF-8編]</h1>
<hr>
</div>
</div>
<div class=row>
<div class="col-sm-12 col-md-10 col-md-offset-1">
ちょっと思うところあって調べたのでメモしておきます。<br>
結局使わない事になったんですが。<br>
<pre>mb_regex_encoding('UTF-8');
if (preg_match("/^[ぁ-んー]+$/u", $str)) {
    // ひらがな
} else if (preg_match("/^[ァ-ヶー]+$/u", $str)) {
    // カタカナ
} else if (preg_match("/^[一-龠]+$/u", $str)) {
    // 漢字
}</pre>
mb_regex_encoding('UTF-8'); は正規表現の基準となる文字コードの指定です。<br>
php.ini がいじれる環境なら、[mbstring] セクションに、mbstring.internal_encoding = UTF-8 とした方が良いかと思います。<br>
<br>
[あ-ん] 等の指定は、Unicode 上でひらがなやカタカナを表す文字コードの最初と最後の文字を、範囲指定しています。<br>
また、厳密に言うと漢字の最後は "龠" では無いのですが、一般的に漢字と見なされる範囲の中で、最後にある JIS 第二水準の漢字であるため、この字を採用しています。(この漢字の範囲には、中国の漢字やハングルなどが含まれます)<br>
全然異なる文脈ですが、<a href=http://www.tanimoto.to/comp/bm.html target=_blank>このページ</a>で詳しく考察されています。<br>
<br>
preg_match の u フラグは、UTF-8 を正しく扱えるようにするためのフラグです。これがないと、文字コードの範囲指定などが正しく動作しないようです。
</div>
</div>
<div class=row>
<div class="col-sm-12 col-md-10 col-md-offset-1">
<hr>
カテゴリ:
<a href=/category/dev/ >Development</a>
タグ:
<a href=/tag/php/ >php</a>
<a href=/tag/utf-8/ >utf-8</a>
</div>
</div>
<div class=row>
<div class="col-sm-12 col-md-10 col-md-offset-1">
<hr>
</div>
<div class="col-sm-12 col-md-10 col-md-offset-1 col-lg-5 col-lg-offset-1 prev">
<a href=/20090120/first-five-lines-of-greasemonkey/ >Greasemonkey スクリプトの冒頭に書く 5 行</a>
</div>
<div class="col-sm-12 col-md-10 col-md-offset-1 col-lg-5 col-lg-offset-0 next">
<a href=/20090131/2eco-of-seiyu-self-register/ >西友のセルフレジを取り巻く２つのエコ</a>
</div>
</div>
</main>
<footer>
<div class="col-sm-12 col-md-10 col-md-offset-1">
Copyright © OTCHY.NET authored by <a href=https://twitter.com/otchy target=_blank>@otchy</a>
</div>
</footer>
</body>
</html>
